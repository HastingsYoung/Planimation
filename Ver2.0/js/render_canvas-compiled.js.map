{"version":3,"sources":["render_canvas.js"],"names":[],"mappings":"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","file":"render_canvas-compiled.js","sourcesContent":["let array = localStorage.getItem('file_container');\nif (!array) {\n    alert(\"Please Load Requisite Files Before Entering This Page!\");\n    window.location.href = \"../index.html\";\n}\narray = JSON.parse(array);\n\nlet domain = PDDL_Parser.parse(array[0]);\nconsole.log(domain);\nlet problem = PDDL_Parser.parse(array[1]);\nconsole.log(problem);\nlet solution = Plan_Parser.parse(array[2]);\nconsole.log(solution);\n\nlet animationFuncs = [];\n\n// blocks\nconst blocksWorldMappings = [{\n    name: \"on\",\n    true_func: function (id, o1, o2) {\n        return {\n            id: id,\n            x: o2.x,\n            y: o2.y + 60\n        }\n    },\n    false_func: function (id, o1, o2) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    }\n}, {\n    name: \"ontable\",\n    true_func: function (id, o1) {\n        return {\n            id: id,\n            x: 150 + Math.random() * 100,\n            y: 150 + Math.random() * 100\n        }\n    },\n    false_func: function (id, o1) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    }\n}, {\n    name: \"clear\",\n    true_func: function (id, o1) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    },\n    false_func: function (id, o1) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    }\n}, {\n    name: \"handempty\",\n    true_func: function (id, o1) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    },\n    false_func: function (id, o1) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    }\n}, {\n    name: \"holding\",\n    true_func: function (id, o1) {\n        return {\n            id: id,\n            x: 620,\n            y: 220\n        }\n    },\n    false_func: function (id, o1) {\n        return {\n            id: id,\n            x: o1.x,\n            y: o1.y\n        }\n    }\n}];\n\nconst domainMappings = {\n    \"BLOCKSWORLD\": blocksWorldMappings\n}\n\nconst selectMapping = (domain)=> {\n    return domainMappings[domain.toUpperCase()]\n}\n\nlet initialMappings = [];\ninitialMappings = selectMapping(\"blocksworld\");\n\n/**\n *  A Singleton Factory responsible for generating template files.\n *  1. Promise Style.\n *  2. Usage:\n *      A - import:\n *      var fct = TemplateFactory.getInstance({\n *      importSelector: \"#block\",   // optionally, use importSelectorAll, which imports all relevant elements on the page\n *      });\n *      B - prototype:\n *      var fct = TemplateFactory.getInstance();\n *      fct.setPrototype(pro, \"text/html\");     // where pro is a string or a DOM object either in variable form or as an array\n *      C - get template:\n *      var temp = fct.newTemplate().cloneNode(true);   // if cloneNode is not used, the template would be identical last generation\n * */\nvar TemplateFactory = (function () {\n// static assignment is not supported by babel compiler, thus the factory_instance variable is extracted out here\n    let factory_instance = null;\n    class Factory {\n        constructor(props) {\n            if (!factory_instance) {\n                if (props) {\n                    var keys = Object.keys(props);\n                    for (var k in keys) {\n                        if (this[keys[k]]) {\n                            this[keys[k]](props[keys[k]]);\n                        }\n                    }\n                }\n                factory_instance = this;\n            }\n            return factory_instance;\n        };\n\n        importSelector(pattern) {\n            this._link = document.querySelector(pattern);\n            this._content = this._link.import;\n            return this;\n        }\n\n        importSelectorAll(pattern) {\n            this._link = document.querySelectorAll(pattern);\n            var contents = [];\n            for (var l in this._link) {\n                contents.push(this._link[l].import);\n            }\n            this._content = contents;\n            return this;\n        }\n\n        setPrototype(pro, type) {\n            var _type = type ? type : \"text/html\";\n            if (typeof pro == \"string\") {\n                pro = pro.replace(/>\\s+([^\\s<]*)\\s+</g, '>$1<').trim();\n                var parser = new DOMParser();\n                var domPrototype = parser.parseFromString(pro, _type);\n                this._contentType = _type;\n                if (_type === \"text/html\") {\n                    this._prototype = domPrototype.querySelector(\".template\");\n                    this._prototype.dataContent = this._prototype.querySelector('.template-data').value;\n                } else {\n                    this._prototype = domPrototype;\n                }\n            } else if (pro && pro.length > 1) {\n                var parser = new DOMParser();\n                var domPrototype = [];\n                for (var p in pro) {\n                    domPrototype.push(parser.parseFromString(pro[p], _type));\n                }\n                ;\n                this._contentType = _type;\n                if (_type === \"text/html\") {\n                    this._prototype = domPrototype.querySelector(\".template\");\n                    this._prototype.dataContent = this._prototype.querySelector('.template-data').value;\n                } else if (pro.dataContent) {\n                    // the code of bulk reading hasn't been corrected, will do this later\n                    this._prototype = domPrototype;\n                    this._prototype.dataContent = pro.dataContent;\n                } else {\n                    throw new Error(\"Cannot initiate a prototype without a data!\");\n                }\n            } else if (pro && (_type === \"text/html\")) {\n                this._prototype = pro.querySelector(\".template\");\n                this._prototype.dataContent = this._prototype.querySelector('.template-data').value;\n            }\n            else if (pro && pro.dataContent)\n                this._prototype = pro;\n            else if (this._content) {\n                this.setPrototype(this._content, \"text/html\");\n                // must replace(/>\\s+([^\\s<]*)\\s+</g, '>$1<').trim(); before parsing\n            } else\n                throw \"No valid prototype available!\";\n            return this;\n        }\n\n        newTemplate() {\n            if (this._prototype)\n                return this._prototype;\n            else if (this._content) {\n                if (typeof this._content === \"string\" && this._contentType === \"text/html\") {\n                    this.setPrototype(this._content);\n                } else if (this._content.length > 1) {\n                    var prototypes = [];\n                    for (var c in this._content) {\n                        prototypes.push(this._content[c]);\n                    }\n                    this.setPrototype(prototypes);\n                } else {\n                    this.setPrototype(this._content, this._contentType);\n                }\n                return this._prototype;\n            }\n            throw \"Prototype not defined!\";\n        }\n\n        init() {\n            this._prototype = null;\n            this._link = null;\n            this._content = null;\n            return this;\n        }\n    }\n    ;\n    return {\n        getInstance: function (props) {\n            return new Factory(props);\n        },\n    };\n}());\n\n/**\n *  Components to be shown and operated on.\n *  @render() render component to tabs\n *  @resetClass() reset class name bound to component\n *  @parseDom() parse string as DOM element\n * */\nclass Component {\n    constructor(props) {\n        var keys = Object.keys(props);\n        for (var k in keys) {\n            this[keys[k]] = props[keys[k]];\n        }\n    }\n\n    render() {\n        this.bindClass(\"selected\");\n    }\n\n    resetClass(className) {\n        if (className) {\n            $(this.node).removeClass(className);\n            $(this.node).off(\"click\");\n            return;\n        }\n        $(this.node).removeClass(\"selected\");\n        $(this.node).off(\"click\");\n    }\n\n    bindClass(className) {\n        if (!className)\n            throw new Error(\"No Class Name Entered Exception At 'bindClass' Method of Component class!\");\n        let node = this.node;\n        // use a component node to point back to component\n        node.component = this;\n        this.customizeContent(node, this.name);\n        document.querySelector(this.parentSelector).appendChild(node);\n\n        $(node).click(function () {\n            if (!$(this).hasClass(className)) {\n                $(this).siblings().each(function () {\n                    $(this).removeClass(className);\n                });\n                $(this).addClass(className);\n            }\n            // do not allow removing click\n            //else\n            //    $(this).removeClass(className);\n        });\n    }\n\n    parseDom(str) {\n        let parser = new DOMParser();\n        str = str.replace(/>\\s+([^\\s<]*)\\s+</g, '>$1<').trim();\n        let domPrototype = parser.parseFromString(str, \"text/html\");\n        return domPrototype.body.childNodes[0];\n    }\n\n    customizeContent(node, titl, cont) {\n        let title = node.querySelector(\"p.template-title\");\n        let content = node.querySelector(\"p.template-desc\");\n        if (titl) {\n            title.innerHTML = titl;\n        } else {\n            if (title)\n                title.parentNode.removeChild(title);\n        }\n        if (cont) {\n            content.innerHTML = cont;\n        } else {\n            if (content)\n                content.parentNode.removeChild(content);\n        }\n    }\n\n    getLogoLink() {\n        let obj = JSON.parse(this.node.querySelector(\"input\").value);\n        return obj.data.logo;\n    }\n}\n\nclass Model extends Component {\n\n    constructor(props) {\n        super(props);\n        this.obj = JSON.parse(this.node.querySelector(\"input\").value);\n    }\n\n    renderModal(parentNode) {\n\n        var obj = this.obj;\n        var tags = \"\";\n        for (var t in obj.data.domaintags) {\n            tags += \"<span>\" + obj.data.domaintags[t] + \"</span>\";\n        }\n        var nodeContent = \"<div class='model'>\" +\n            \"<header><h3 class='modelid'>Model Id: \" + this.id +\n            \"</h3></header><div class='content'><div class='tags'>\" + \"<img src='\" + obj.data.logo + \"' alt='No Image Available'>\" +\n            \"<div class='sub_header'><h5>Domain Type: </h5>\" + \"<span>\" + obj.data.domaintype + \"</span>\" +\n            \"</div><div class='sub_header'><h5>Domain Tags: </h5>\" + tags + \"</div>\" +\n            \"</div><div class='description'><h5>Description: </h5><p>\" + obj.data.domaindescription + \"</p></div></div>\" +\n            \"<span class='modal-btns'><div class='file-upload-btn'><input type='file'/><span><i class='fa fa-cloud-upload'></i>Upload</span></div></span></div>\";\n        let _this = this;\n        if (parentNode) {\n            parentNode.appendChild(nodeContent);\n            parentNode.querySelector(\"input\").addEventListener(\"change\", function (evt) {\n                previewImage(_this.node.querySelector(\"img\"), evt.target.files[0], function (imgLink) {\n                    _this.obj.data.logo = imgLink;\n                });\n                previewImage(parentNode.querySelector(\"img\"), evt.target.files[0]);\n            });\n        }\n        else if (this.modalSelector) {\n            document.querySelector(this.modalSelector).appendChild(this.parseDom(nodeContent));\n            document.querySelector(this.modalSelector).querySelector(\"input\").addEventListener(\"change\", function (evt) {\n                previewImage(_this.node.querySelector(\"img\"), evt.target.files[0], function (imgLink) {\n                    _this.obj.data.logo = imgLink;\n                });\n                previewImage(document.querySelector(_this.modalSelector).querySelector(\"img\"), evt.target.files[0]);\n            });\n        }\n\n    }\n\n    render() {\n        this.bindClass(\"selected\");\n        //this.node.addEventListener(\"dragstart\", function (event) {\n        //    console.log(\"dragstart\");\n        //    event.target.className += \" dragging\";\n        //}, false);\n        //\n        //var obj = this.obj;\n\n        //const offsetWidth = document.querySelector(\".side_menu\").offsetWidth;\n        //const offsetHeight = this.node.offsetHeight;\n\n        //const _id = this.id;\n        //this.node.addEventListener(\"dragend\", function (event) {\n        //    console.log(\"dragend\");\n        //    var reg = new RegExp('(\\\\s|^)' + \"dragging\" + '(\\\\s|$)');\n        //    event.target.className = event.target.className.replace(reg, ' ');\n        //\n        //    d3.select(\".canvas > svg\").append(\"image\").attr(\"id\", _id).classed(\"drag-ele\", true).attr(\"width\", 40).attr(\"height\", 40).attr(\"href\", obj.data.logo).attr(\"transform\", function () {\n        //        return \"translate(\" + (event.x - offsetWidth) + \",\" + (event.y - offsetHeight) + \")\";\n        //    }).attr(\"fill\", \"#eee\");\n        //    d3.select(\"#\" + _id).data([{x: event.x - offsetWidth, y: event.y - offsetHeight}]).call(drag);\n        //    event.stopPropagation();\n        //}, false);\n        //\n        //this.node.addEventListener(\"dragover\", function (event) {\n        //    console.log(\"dragover\");\n        //}, false);\n    }\n}\n\nvar drag = d3.drag().on(\"drag\", function (d, i) {\n    d.x += d3.event.dx;\n    d.y += d3.event.dy;\n    d3.select(this).attr(\"transform\", function (d, i) {\n        return \"translate(\" + d.x + \",\" + d.y + \")\";\n    });\n});\n\n//const randomGenerator = function () {\n//    var timeStamp = Date.parse(new Date());\n//    timeStamp = timeStamp / 1000;\n//    // substr(2) can delete first two digit, which are numbers not needed\n//    return Math.random().toString(26).substr(2) + timeStamp;\n//}\n\nclass Action extends Component {\n    renderModal(parentNode) {\n        var parameters = \"\", preconditions = \"\", effects = \"\";\n        for (var t in this.data.parameters) {\n            parameters += \"<span>\" + this.data.parameters[t].name + \"</span>\";\n        }\n\n        //for (var t in obj.data.preconditions) {\n        //    preconditions += \"<span>\" + obj.data.preconditions[t].state + \"(\" + obj.data.preconditions[t].operators.join(\",\") + \"): \" +\n        //        obj.data.preconditions[t].predicate + \"</span>\";\n        //}\n\n        for (var t in this.data.effects) {\n            let args = [];\n            for (var k in this.data.effects[t].parameters) {\n                args.push(this.data.effects[t].parameters[k].name);\n            }\n            effects += \"<span>\" + this.data.effects[t].name + \"(\" + args.join(\",\") + \"): \" +\n                this.data.effects[t].truthiness + \"</span>\";\n        }\n\n        var nodeContent = \"<div class='action'>\" +\n            \"<header><h3 class='name'>Action Name: \" + this.data.name +\n            \"</h3></header><div class='content'><div class='tags'>\" +\n            \"<div class='sub_header'><h5>Parameters: </h5>\" + parameters +\n            \"</div>\"/*<div class='sub_header'><h5>Preconditions: </h5>\" + preconditions + \"</div>\"*/ +\n            \"<div class='sub_header'><h5>Effects: </h5>\" + effects + \"</div>\" +\n            \"</div><div class='description'><h5>Description: </h5><p>Action description...</p></div></div></div>\";\n        if (parentNode)\n            parentNode.appendChild(nodeContent);\n        else if (this.modalSelector)\n            document.querySelector(this.modalSelector).appendChild(this.parseDom(nodeContent));\n    }\n}\n\nclass Predicate extends Component {\n    renderModal(parentNode) {\n        var args = []\n\n        for (var t in this.data.parameters) {\n            args.push(this.data.parameters[t].name);\n        }\n\n        var predicates = \"(\" + args.join(\",\") + \")\";\n\n        var nodeContent = \"<div class='predicate'>\" + \"<header><h3 class='name'>Predicate Name: \" + this.data.name +\n            \"</h3></header>\" + \"<div class='content'><div class='tags'>\" +\n            \"<div class='sub_header'><h5>Predicates: </h5>\" + predicates + \"</div>\" + \"<span><label><i class='fa fa-plus-square fa-2x' aria-hidden='true'></i></label><input class='predicate-true' placeholder='True Condition'/></span>\"\n            + \"<span><label><i class='fa fa-minus-square fa-2x' aria-hidden='true'></i></label><input class='predicate-false' placeholder='False Condition' /></span><span class='modal-btns'>\" +\n            \"<button id='modal-predicate-confirm' class='btn-confirm'>Confirm</button><button class='btn-cancel'>Cancel</button></span>\" + \"</div><div class='modal-divider'></div><div class='description'><h4>Example</h4>\" +\n            \"<p>If we've got variable (?a,?b) then the input should be x:a.x+b.x+10;y:a.y*10-b.y</p></div></div></div>\";\n        if (parentNode)\n            parentNode.appendChild(nodeContent);\n        else if (this.modalSelector)\n            document.querySelector(this.modalSelector).appendChild(this.parseDom(nodeContent));\n        let _this = this;\n        $(\"#modal-predicate-confirm\").click(function () {\n            let tValue = $(\".predicate-true\").val();\n            let fValue = $(\".predicate-false\").val();\n            var arrT = tValue.trim().split(\";\");\n            var arrF = fValue.trim().split(\";\");\n            var arrXT = arrT[0].split(\":\");\n            var arrYT = arrT[1].split(\":\");\n            var arrXF = arrF[0].split(\":\");\n            var arrYF = arrF[1].split(\":\");\n            const funcBodyT = \"(function(id,\" + args.join(\",\").replace(/\\?/g, \"\") + \"){return {id:id,'x':\" + arrXT[1] + \",'y':\" + arrYT[1] + \"}})\";\n            const funcBodyF = \"(function(id,\" + args.join(\",\").replace(/\\?/g, \"\") + \"){return {id:id,'x':\" + arrXF[1] + \",'y':\" + arrYF[1] + \"}})\";\n            animationFuncs.push({\n                name: _this.data.name,\n                true_func: eval(funcBodyT),\n                false_func: eval(funcBodyF)\n            });\n            console.log(animationFuncs);\n            $(\".modal\").removeClass(\"active\");\n        });\n    }\n}\n\nclass Images extends Component {\n\n    constructor(props) {\n        super(props);\n        this.obj = JSON.parse(this.node.querySelector(\"input\").value);\n    }\n\n    renderModal(parentNode) {\n\n        var obj = this.obj;\n        var nodeContent = \"<div class='model'>\" +\n            \"<header><h3 class='modelid'>Image Id: \" + this.id +\n            \"</h3></header><div class='content'><div class='content-left'>\" + \"<img src='\" + obj.data.logo + \"' alt='No Image Available'>\" +\n            \"<span class='modal-btns'>\" +\n            \"<div class='file-upload-btn modal-btn'><input type='file'/><span>Upload</span></div></span></div><div class='modal-divider'></div>\" +\n            \"<div class='content-right'>\" +\n            \"<span><label><i class='fa fa-arrows-h' aria-hidden='true'></i></label><input id='image-width' type='text' placeholder='Image Width'></span>\" +\n            \"<span><label><i class='fa fa-arrows-v' aria-hidden='true'></i></label><input id='image-height' type='text' placeholder='Image Height'></span>\" +\n            \"<span class='modal-btns'><button id='modal-image-confirm'>Confirm</button></span></div></div></div>\";\n        let _this = this;\n        if (parentNode) {\n            parentNode.appendChild(nodeContent);\n            parentNode.querySelector(\"input\").addEventListener(\"change\", function (evt) {\n                previewImage(_this.node.querySelector(\"img\"), evt.target.files[0], function (imgLink) {\n                    _this.obj.data.logo = imgLink;\n                });\n                previewImage(parentNode.querySelector(\"img\"), evt.target.files[0]);\n            });\n        }\n        else if (this.modalSelector) {\n            document.querySelector(this.modalSelector).appendChild(this.parseDom(nodeContent));\n            document.querySelector(this.modalSelector).querySelector(\"input\").addEventListener(\"change\", function (evt) {\n                previewImage(_this.node.querySelector(\"img\"), evt.target.files[0], function (imgLink) {\n                    _this.obj.data.logo = imgLink;\n                });\n                previewImage(document.querySelector(_this.modalSelector).querySelector(\"img\"), evt.target.files[0]);\n            });\n        }\n        $(\"#modal-image-confirm\").click(function () {\n            let width = $(\"#image-width\").val();\n            let height = $(\"#image-height\").val();\n            if (checkNum(width) && checkNum(height)) {\n                _this.obj.data.width = width;\n                _this.obj.data.height = height;\n                $(\".modal\").removeClass(\"active\");\n            } else {\n                alert(\"Please input number as reuqired!\");\n            }\n        });\n    }\n\n    render() {\n        this.node = this.node.cloneNode(true);\n        this.bindClass(\"selected\");\n        this.node.addEventListener(\"dragstart\", function (event) {\n            console.log(\"dragstart\");\n            event.target.className += \" dragging\";\n        }, false);\n\n        var obj = this.obj;\n\n        const offsetWidth = document.querySelector(\".side_menu\").offsetWidth;\n        const offsetHeight = this.node.offsetHeight;\n\n        const _id = this.id;\n        this.node.addEventListener(\"dragend\", function (event) {\n            console.log(\"dragend\");\n            var reg = new RegExp('(\\\\s|^)' + \"dragging\" + '(\\\\s|$)');\n            event.target.className = event.target.className.replace(reg, ' ');\n\n            d3.select(\".canvas > svg\").append(\"image\").attr(\"id\", _id).classed(\"drag-ele\", true).attr(\"width\", obj.data.width).attr(\"height\", obj.data.height).attr(\"href\", obj.data.logo).attr(\"transform\", function () {\n                return \"translate(\" + (event.x - offsetWidth) + \",\" + (event.y - offsetHeight) + \")\";\n            }).attr(\"fill\", \"#eee\");\n            d3.select(\"#\" + _id).data([{x: event.x - offsetWidth, y: event.y - offsetHeight}]).call(drag);\n            event.stopPropagation();\n        }, false);\n\n        this.node.addEventListener(\"dragover\", function (event) {\n            console.log(\"dragover\");\n        }, false);\n    }\n}\n\n/**\n *  Page Renderer.\n *  1. Promise Style.\n *  2. Usage:\n *      A - add component:\n *          var renderer =  Renderer.getInstance({\n *          key1: component1\n *          key2: component2\n *          key3: component3\n *          // ...\n *          }).init();\n *\n *      B - clear components:\n *          renderer.clear();\n *\n *      C - render component with specific key:\n *          renderer.render(key);\n *\n * */\nvar Renderer = (function () {\n    class RendererInstance {\n        constructor() {\n        }\n\n        addComponent(key, components) {\n            if (!this.components)\n                this.components = {};\n            this.components[key] = components;\n            return this;\n        }\n\n        init() {\n            var keys = Object.keys(this.components);\n            for (var k in keys) {\n                var group = keys[k];\n                for (var c in this.components[group]) {\n                    var q = this.components[group][c].parentSelector;\n                    if (q)\n                        document.querySelector(q).innerHTML = \"\";\n                }\n            }\n            this.render(keys[0]);\n            return this;\n        }\n\n        clear(key) {\n            if (key) {\n                for (var c in this.components[key]) {\n                    var q = this.components[key][c].parentSelector;\n                    if (q)\n                        document.querySelector(q).innerHTML = \"\";\n                }\n                return this;\n            }\n\n            var keys = Object.keys(this.components);\n            for (var k in keys) {\n                var group = keys[k];\n                for (var c in this.components[group]) {\n                    var q = this.components[group][c].parentSelector;\n                    if (q)\n                        document.querySelector(q).innerHTML = \"\";\n                    this.components[group][c].resetClass();\n                }\n            }\n            return this;\n        }\n\n        render(key) {\n            if (key) {\n                for (var c in this.components[key]) {\n                    this.components[key][c].render();\n                }\n                return this;\n            }\n\n            var keys = Object.keys(this.components);\n            for (var k in keys) {\n                var group = keys[k];\n                for (var c in this.components[group]) {\n                    this.components[group][c].render();\n                }\n            }\n            return this;\n        }\n    }\n\n    return {\n        getInstance: function (maps) {\n            var renderer = new RendererInstance();\n            var keys = Object.keys(maps);\n            for (var m in keys) {\n                renderer.addComponent(keys[m], maps[keys[m]]);\n            }\n            return renderer;\n        }\n    }\n}());\n\nvar fct = TemplateFactory.getInstance({importSelector: \"#basic_block\"});\nvar template = fct.newTemplate();\nvar models = [];\nfor (var i = 0; i < problem[0].names.length; i++) {\n    models.push(new Model({\n        name: problem[0].names[i],\n        parentSelector: '.preload',\n        modalSelector: '.modal > .modal_panel > .modal_content',\n        id: \"object-\" + problem[0].names[i],\n        node: template.cloneNode(true)\n    }));\n}\n\nfct.importSelector(\"#basic_action\").setPrototype();\ntemplate = fct.newTemplate();\nvar actions = [];\nfor (var i in domain[3]) {\n    actions.push(new Action({\n        name: domain[3][i].name,\n        parentSelector: '.preload',\n        modalSelector: '.modal > .modal_panel > .modal_content',\n        node: template.cloneNode(true),\n        data: domain[3][i]\n    }));\n}\n\nfct.importSelector(\"#basic_predicate\").setPrototype();\ntemplate = fct.newTemplate();\nvar predicates = [];\nfor (var i in domain[2]) {\n    predicates.push(new Predicate({\n        name: domain[2][i].name,\n        parentSelector: '.preload',\n        modalSelector: '.modal > .modal_panel > .modal_content',\n        node: template.cloneNode(true),\n        data: domain[2][i]\n    }));\n}\n\nfct.importSelector(\"#basic_image\").setPrototype();\ntemplate = fct.newTemplate();\nvar images = [];\nfor (var i = 0; i < 9; i++) {\n    images.push(new Images({\n        name: \"image-\" + i,\n        parentSelector: '.preload',\n        modalSelector: '.modal > .modal_panel > .modal_content',\n        node: template.cloneNode(true),\n        id: \"image-\" + i,\n        data: {}\n    }));\n}\n\n/**\n *  @steps animation data\n *  #example\n *  steps = [{\n *      id: \"objId\",\n *      x: \"objX\",\n *      y: \"objY\"\n *  },{\n *      id: \"objId\",\n *      x: \"objX\",\n *      y: \"objY\"\n *  },[{\n *      id: \"objId\",\n *      x: \"objX\",\n *      y: \"objY\"\n *  },{\n *      id: \"objId\",\n *      x: \"objX\",\n *      y: \"objY\"\n *  }]]\n * */\nvar Animation = (function () {\n\n    let colors = [\"red\", \"blue\", \"purple\", \"gray\", \"brown\", \"green\", \"skyblue\", \"black\", \"silver\", \"pink\", \"yellow\", \"darkgoldenrod\"]\n    let _settings = {\n        \"LARGE\": 100,\n        \"MEDIUM\": 50,\n        \"SMALL\": 30,\n        \"RED\": 0,\n        \"BLUE\": 1,\n        \"PURPLE\": 2,\n        \"GRAY\": 3,\n        \"BROWN\": 4,\n        \"GREEN\": 5,\n        \"SKYBLUE\": 6,\n        \"BLACK\": 7,\n        \"SILVER\": 8,\n        \"PINK\": 9,\n        \"YELLOW\": 10,\n        \"DARKGOLDENROD\": 11,\n        \"10COLORSCHEMA\": 10,\n        \"FONT_LARGE\": \"40px\",\n        \"FONT_MEDIUM\": \"25px\",\n        \"FONT_SMALL\": \"15px\",\n        \"PLAY_FAST\": 200,\n        \"PLAY_MEDIUM\": 500,\n        \"PLAY_SLOW\": 800\n    };\n\n    function _applySettings(options) {\n        let sts = {\n            width: _settings.MEDIUM,\n            height: _settings.MEDIUM,\n            fontSize: \"15px\",\n            dx: 0,\n            dy: _settings.MEDIUM + 20,\n            speed: _settings.PLAY_SLOW\n        }\n        if (options) {\n            sts = Object.assign({}, sts, options);\n        }\n        return sts;\n    }\n\n    function _register(initials, options) {\n        if (!(initials.length > 0))\n            throw \"Initial states not correct!\";\n        else {\n            let sts = _applySettings(options);\n            let group = d3.select(\".canvas > svg\").selectAll(\"g\").data(initials).enter().append(\"g\").attr(\"class\", \"group\").attr(\"id\", function (d, i) {\n                return d.id;\n            }).attr(\"transform\", function (d, i) {\n                return \"translate(\" + d.x + \",\" + d.y + \")\";\n            });\n            group.append(\"image\").attr(\"width\", sts.width).attr(\"height\", sts.height).attr(\"href\", function (d, i) {\n                var obj = models[i].obj;\n                return obj.data.logo;\n            });\n            group.append(\"text\").attr(\"dx\", function (d, i) {\n                return sts.dx;\n            }).attr(\"dy\", function (d, i) {\n                return sts.dy;\n            }).attr(\"font-size\", sts.fontSize).text(function (d, i) {\n                return \"Object-\" + d.id;\n            });\n        }\n        return this;\n    }\n\n    function _clear() {\n        let canvas = $(\".canvas > svg\");\n        canvas.empty();\n    }\n\n    function _play(steps, options) {\n        console.log(steps);\n        let sts = _applySettings(options);\n        for (var s in steps) {\n            if (steps[s].length > 0) {\n                for (var o in steps[s]) {\n                    d3.select(\"#\" + steps[s][o].id).transition().attr(\"transform\", function (d, i) {\n                        return \"translate(\" + steps[s][o].x + \",\" + steps[s][o].y + \")\";\n                    }).delay(s * sts.speed);\n                }\n            } else {\n                d3.select(\"#\" + steps[s].id).transition().attr(\"transform\", function (d, i) {\n                    return \"translate(\" + steps[s].x + \",\" + steps[s].y + \")\";\n                }).delay(s * sts.speed);\n            }\n        }\n        AxisPlayer.play(sts.speed);\n        return this;\n    }\n\n    return {\n        register: _register,\n        play: _play,\n        clear: _clear,\n        settings: _settings\n    }\n}());\n\nlet animationOptions = {\n    width: Animation.settings.MEDIUM,\n    height: Animation.settings.MEDIUM,\n    fontSize: Animation.settings.FONT_MEDIUM,\n    dx: 0,\n    dy: Animation.settings.MEDIUM + 20,\n    speed: Animation.settings.PLAY_SLOW\n}\n\n// todo this if the domain change order of arguments\nconst ArgsToIndexMapper = (arg)=> {\n    const mapper = {\"?x\": 0, \"?y\": 1, \"?z\": 2};\n    if (mapper[arg] || mapper[arg] == 0)\n        return mapper[arg];\n    throw new Error(\"Argument \" + arg + \" is not recognizable: Argument order need to be changed if domain is using special order of letters other than alphabet!\");\n}\n\n/**\n *  transform raw data to animation objects\n *  @getInit()\n *  @initialte()\n *  @transform()\n * */\nvar Transformer = (function () {\n    var _initialStates = {};\n    var _predicates = [];    // inherently they are functions that map last state to next state\n    var _actions = {};\n    var _solutions = [];   // store actual solutions objects to represent what is the next pair of coordinates\n    var _dataArray = [];\n\n    /**\n     * @predicates domain[2].map((o)=>{\n     *      return {\n     *          name: o.name,\n     *          // get coordinates of id from o1 and o2\n     *          func: function(id,o1,o2){\n     *              return {\n     *                  id: id,\n     *                  x: o1.x + o2.x,\n     *                  y: o1.y - 10\n     *              }\n     *          }\n     *      }\n     * })\n     * @init var init = problem[1].map((o)=> {\n     *              if (o.parameters)\n     *                  return {\n     *                      name: o.name,\n     *                      args: o.parameters.map((p)=>{\n     *                          return p.value;\n     *                      })\n     *                  }\n     *          });\n     * @solutions solutions\n     * @actions domain action definitions\n     * */\n    function _initiate(predicates, init, solutions, actions) {\n        _clear();\n        if (!init || !solutions || !predicates || !actions) {\n            throw \"Arguments Not Correct!\"\n        }\n        for (var p in predicates) {\n            if (typeof predicates[p].true_func == \"function\" && typeof predicates[p].false_func == \"function\")\n                _predicates[predicates[p].name] = {\n                    \"true\": predicates[p].true_func,\n                    \"false\": predicates[p].false_func\n                };\n            else\n                throw \"Object in Array of Predicates is not Function\";\n        }\n\n        for (var a in actions) {\n            _actions[actions[a].name] = {\n                name: actions[a].name,\n                effects: actions[a].effects\n            };\n        }\n\n        // base cases\n        for (var i in init) {\n            //if (init[i].args.length == 1) {\n            if (init[i].args[0])\n                _initialStates[init[i].args[0]] = {\n                    id: init[i].args[0],\n                    x: 500,\n                    y: 50\n                };\n            //}\n        }\n\n        // derivative cases\n        var loopStack = [];\n        for (var i in init) {\n            if (init[i].args.length > 1) {\n                var b = true;\n                /** as the input order of arguments are now in dependent order, we don't need a loopStack to handle non-existence dependencies\n                 * but would be useful in the future ⤵\n                 */\n                for (var arg = 1; arg < init[i].args.length; arg++) {\n                    // if any dependent argument does not exist(the first one is variable to be calculated)\n                    if (!_initialStates[init[i].args[arg]]) {\n                        loopStack.push({\n                            args: init[i].args,\n                            name: init[i].name\n                        });\n                        b = false;\n                        break;\n                    }\n                }\n                // if every dependencies is able to be found, set a mapping between first argument and its dependencies\n                if (b) {\n                    if (init[i].truthiness == \"true\")\n                    // init[i].args[0]: the first argument is always the argument to be operated on\n                        _initialStates[init[i].args[0]] = _predicates[init[i].name].true(init[i].args[0], ...(init[i].args.map((p, index)=> {\n                            return _initialStates[init[i].args[index]];\n                        })));\n                    else\n                        _initialStates[init[i].args[0]] = _predicates[init[i].name].false(init[i].args[0], ...(init[i].args.map((p, index)=> {\n                            return _initialStates[init[i].args[index]];\n                        })));\n                }\n            }\n        }\n        /** as the input order of arguments are now in dependent order, we don't need a loopStack to handle non-existence dependencies\n         * but would be useful in the future ⤵\n         */\n\n        //while (loopStack.length > 0) {\n        //    var obj = loopStack.pop();\n        //    var t = true;\n        //    for (var a = 1; a < obj.args.length; a++) {\n        //        if (!_initialStates[obj.args[a]]) {\n        //            loopStack.push({\n        //                args: obj.args,\n        //                name: obj.name\n        //            });\n        //            t = false;\n        //            break;\n        //        }\n        //    }\n        //    if (t)\n        //        _initialStates[args[0]] = _predicates[obj.name](obj.args[0], _initialStates[obj.args[1]]);\n        //}\n\n        for (var s in solutions) {\n            _solutions.push({\n                name: solutions[s].name,\n                args: solutions[s].parameters.map((pr)=> {\n                    return pr.value;\n                })\n            });\n        }\n        return this;\n    }\n\n    function _clear() {\n        _initialStates = {};\n        _predicates = [];    // inherently they are functions that map last state to next state\n        _actions = {};\n        _solutions = [];   // store actual solutions objects to represent what is the next pair of coordinates\n        _dataArray = [];\n    }\n\n    function _transform() {\n        // transform...\n        for (var s in _solutions) {\n            var effs = _actions[_solutions[s].name].effects;\n            var stack = [];\n            for (var e in effs) {\n                // specify which parameter should be map to which argument(in index)\n                let indices = effs[e].parameters ? effs[e].parameters.map((prs)=>(ArgsToIndexMapper(prs.name))) : [];\n\n                // 1. map arguments in solution to function in initialStates\n                // 2. expand initialStates array as arguments from the 2nd to last at predicate function\n                // 3. the first argument of predicate function is object id/name\n                if (effs[e].truthiness == \"true\") {\n                    let arr = (_solutions[s].args.map((sol, index)=> {\n                        if (indices.length > 0)\n                            return _initialStates[_solutions[s].args[indices[index]]];\n                        return _initialStates[_solutions[s].args[index]];\n                    }));\n                    let preObj = arr[0];\n                    let afterObj = _predicates[effs[e].name].true(arr[0].id, ...arr);\n                    if (preObj.x != afterObj.x || preObj.y != afterObj.y)\n                        stack.push(afterObj);\n                }\n                else {\n                    let arr = (_solutions[s].args.map((sol, index)=> {\n                        if (indices.length > 0)\n                            return _initialStates[_solutions[s].args[indices[index]]];\n                        return _initialStates[_solutions[s].args[index]];\n                    }));\n                    let preObj = arr[0];\n                    let afterObj = _predicates[effs[e].name].false(arr[0].id, ...arr);\n                    if (preObj.x != afterObj.x || preObj.y != afterObj.y)\n                        stack.push(afterObj);\n                }\n            }\n            _dataArray.push(stack);\n        }\n        return _dataArray;\n    }\n\n    function _getInitialStates() {\n        var array = [];\n        for (var i in _initialStates) {\n            array.push(_initialStates[i]);\n        }\n        return array;\n    }\n\n    return {\n        getInit: _getInitialStates,\n        initiate: _initiate,\n        transform: _transform\n    }\n}());\n\n/**\n *  Map customize predicate settings to animation config\n * */\nconst predicateMappings = (mappings)=> {\n    if (!mappings) {\n        return initialMappings;\n    }\n    let imap = initialMappings;\n    for (let i = 0; i < imap.length; i++) {\n        for (var j in mappings) {\n            if (mappings[j].name == imap[i].name) {\n                imap[i] = mappings[j];\n            }\n        }\n    }\n    return imap;\n}\n\nconst checkNum = (toCheck)=> {\n    return !isNaN(parseFloat(toCheck));\n}\n\nvar renderInfrastructure = (function () {\n    function _renderTab() {\n        $(\".tab\").each(function () {\n            var _this = $(this);\n            _this.on(\"click\", function () {\n                renderer.clear();\n                renderer.render(_this.attr('id'));\n                _this.addClass(\"active\");\n                _this.siblings().each(function () {\n                    $(this).removeClass(\"active\");\n                });\n            });\n        });\n    }\n\n    function _renderCanvas() {\n        var svg = d3.select(\".canvas\").append(\"svg\").attr(\"width\", \"100%\").attr(\"height\", \"100%\");\n        document.querySelector(\".canvas > svg\").addEventListener(\"drop\", function () {\n            console.log(\"drop\");\n        }, false);\n    }\n\n    function _renderButtons() {\n        // set each cuz for each tab the buttons are different\n        $(\".btn.edit\").each(function () {\n            $(this).click(function () {\n                if (document.querySelector(\".template.selected\")) {\n                    $(\".modal\").addClass(\"active\");\n                    document.querySelector(\".modal > .modal_panel > .modal_content\").innerHTML = \"\";\n                    document.querySelector(\".template.selected\").component.renderModal();\n                }\n                else {\n                    alert(\"Please select a component to view.\");\n                }\n            });\n        });\n        $(\".btn.start\").each(function () {\n            $(this).click(function () {\n                let init = [];\n                for (let p in problem[1]) {\n                    let o = problem[1][p];\n                    init.push({\n                        name: o.name,\n                        args: o.parameters ? o.parameters.map((p)=> {\n                            return p.value;\n                        }) : [],\n                        truthiness: o.truthiness\n                    });\n                }\n                let trans = Transformer.initiate(predicateMappings(animationFuncs), init, solution, domain[3]);\n                // enter initial condition\n                let anime = Animation.register(trans.getInit(), animationOptions);\n                // play steps\n                anime.play(trans.transform(), animationOptions);\n            });\n        });\n        $(\".btn.reset\").each(function () {\n            $(this).click(function () {\n                Animation.clear();\n                AxisPlayer.clear();\n            });\n        });\n        $(\".btn.settings\").each(function () {\n            $(this).click(function () {\n                let str = \"<div class='model'>\" +\n                    \"<header><h3 class='modelid'>Settings</h3></header><div class='content'><div class='content-left'>\" +\n                    \"<span><label><i class='fa fa-arrows-h' aria-hidden='true'></i></label><input id='obj-width' type='text' placeholder='Width'></span>\" +\n                    \"<span><label><i class='fa fa-arrows-v' aria-hidden='true'></i></label><input id='obj-height' type='text' placeholder='Height'></span>\" +\n                    \"<div class='radios'><div class='radio'><label for='font-small'><i class='fa fa-font' aria-hidden='true'></i></label><input id='font-small' type='radio' name='font-size' value='12px'></div>\" +\n                    \"<div class='radio'><label for='font-medium'><i class='fa fa-font fa-2x' aria-hidden='true'></i></label><input id='font-medium' type='radio' name='font-size' value='15px'></div>\" +\n                    \"<div class='radio'><label for='font-large'><i class='fa fa-font fa-3x' aria-hidden='true'></i></label><input id='font-large' type='radio' name='font-size' value='20px'></div></div>\" +\n                    \"</div><div class='modal-divider'></div>\" +\n                    \"<div class='content-right'>\" +\n                    \"<span><label><i class='fa fa-indent' aria-hidden='true'></i></label><input id='obj-offsetx' type='text' placeholder='Offset X'></span>\" +\n                    \"<span><label><i class='fa fa-outdent' aria-hidden='true'></i></label><input id='obj-offsety' type='text' placeholder='Offset Y'></span>\" + \"<div class='radios'><div class='radio'>\" +\n                    \"<input type='radio' name='speed' id='slow' value='800'><label for='slow'>Slow</label></div>\" +\n                    \"<div class='radio'><input type='radio' name='speed' id='medium' value='500'><label for='medium'>Medium</label></div>\" +\n                    \"<div class='radio'><input type='radio' name='speed' id='fast' value='200'><label for='fast'>Fast</label></div></div>\" +\n                    \"</div></div><span class='modal-btns'><button id='modal-settings-confirm'>Confirm</button></span></div>\";\n                let parser = new DOMParser();\n                str = str.replace(/>\\s+([^\\s<]*)\\s+</g, '>$1<').trim();\n                let domPrototype = parser.parseFromString(str, \"text/html\");\n                document.querySelector(\".modal > .modal_panel > .modal_content\").innerHTML = \"\";\n                document.querySelector('.modal > .modal_panel > .modal_content').appendChild(domPrototype.body.childNodes[0])\n                $(\"#modal-settings-confirm\").click(function () {\n                    let width = document.getElementById(\"obj-width\").value;\n                    let height = document.getElementById(\"obj-height\").value;\n                    let offX = document.getElementById(\"obj-offsetx\").value;\n                    let offY = document.getElementById(\"obj-offsety\").value;\n                    if ((width == \"\" || checkNum(width)) && (height == \"\" || checkNum(height)) && (offX == \"\" || checkNum(offX)) && (offY == \"\" || checkNum(offY))) {\n                        if (height)\n                            animationOptions.height = height;\n                        if (width)\n                            animationOptions.width = width;\n                        if (offX)\n                            animationOptions.dy = offY;\n                        if (offY)\n                            animationOptions.dx = offX;\n                        let fontSize = document.getElementsByName(\"font-size\");\n                        fontSize.forEach((f, i)=> {\n                            if (f.checked == true) {\n                                animationOptions.fontSize = f.value;\n                            }\n                        });\n                        let animeSpd = document.getElementsByName(\"speed\");\n                        animeSpd.forEach((spd, i)=> {\n                            if (spd.checked == true) {\n                                animationOptions.speed = parseInt(spd.value);\n                            }\n                        });\n                        $(\".modal\").removeClass(\"active\");\n                    } else {\n                        alert(\"Please enter number!\")\n                    }\n                });\n\n                $(\".modal\").addClass(\"active\");\n            });\n        })\n    }\n\n    function _renderModal() {\n        $(\".btn__close\").click(function () {\n            $(\".modal\").removeClass(\"active\");\n        });\n    }\n\n    function _renderFrames() {\n        for (var s in solution) {\n            var ele = $(\"<div class='element' data-state='\" + s + \"'><label class='number'>\" + s + \"</label><p>\" + solution[s].name + \"</p></div>\");\n            $(\".axis\").append(ele);\n            ele.click(function () {\n                $(this).addClass(\"active\");\n                $(this).siblings().each(function () {\n                    $(this).removeClass(\"active\");\n                });\n            });\n        }\n    }\n\n    function _renderAll() {\n        _renderCanvas();\n        _renderTab();\n        _renderFrames();\n        _renderButtons();\n        _renderModal();\n    }\n\n    return {\n        renderTab: _renderTab,\n        renderCanvas: _renderCanvas,\n        renderFrames: _renderFrames,\n        renderButtons: _renderButtons,\n        renderModal: _renderModal,\n        renderAll: _renderAll,\n    };\n}());\n\nvar AxisPlayer = (function () {\n    let timeoutStack = [];\n    let _play = (speed = 500)=> {\n        $(\".element\").each(function (i, d) {\n            var _this = $(this);\n            let ts = setTimeout(function () {\n                _this.addClass(\"active\");\n            }, speed * i);\n            let te = setTimeout(function () {\n                _this.removeClass(\"active\");\n            }, speed * (i + 1));\n            timeoutStack.push(ts);\n            timeoutStack.push(te);\n        });\n    }\n\n    let _clear = ()=> {\n        timeoutStack.forEach((t)=> {\n            clearTimeout(t);\n            $(\".element\").each(function (i, d) {\n                $(this).removeClass(\"active\");\n            });\n        })\n    }\n\n    return {\n        play: _play,\n        clear: _clear\n    }\n}());\n\n/**\n * Change image of object\n * @previewImage(imgSelector, file, callback);\n * */\nconst previewImage = (imgSelector, file, callback)=> {\n    if (!imgSelector || !file)\n        throw new Error(\"No Selector or File Error\");\n\n    let preview = null;\n    if (typeof imgSelector == \"string\")\n        preview = document.querySelector(imgSelector);\n    else if (typeof imgSelector == \"object\")\n        preview = imgSelector;\n    else throw new Error(\"Selector Type not Recognizable Error\");\n    let reader = new FileReader();\n    reader.addEventListener(\"load\", function () {\n        preview.src = reader.result;\n        if (callback)\n            callback(reader.result);\n    }, false);\n    if (file) {\n        reader.readAsDataURL(file);\n    }\n}\n\nrenderInfrastructure.renderAll();\n\n// modules loading\nvar maps = {\"models\": models, \"actions\": actions, \"predicates\": predicates, \"images\": images};\nvar renderer = Renderer.getInstance(maps);\nrenderer.init();"]}